---
title: drone_learning_note
date: 2025-03-18 15:33:20
tags:
categories: 我的笔记
---
# 无人机、ros、px4必知知识
## 四旋翼飞机的组成
### 机身
#### 机架
##### 指标参数
1. 重量

2. 轴距
两个对角的电机之间中心点的距离
3. 布局
4. 材料
碳纤维材料密度小，刚度和强度大门，提升续航减小震动，但是价格比较贵

#### 起落架
1. 支撑多旋翼重量，保存机身水平
2. 避免飞机与地面发生摩擦
3. 减弱起飞和降落的气流对飞机的干扰
4. 消耗和吸收多旋翼在着陆时的撞击能量

### 动力系统
决定多旋翼系统的主要性能
- 悬停时间
- 载重能力
- 飞行速度
- 飞行距离

#### 1. 螺旋桨
- 相邻的两个桨是不一样的，因为要做扭矩来保持平衡
  - 正桨（不带R）：逆时针旋转
  - 逆桨（带R）：顺时针旋转
  - 一定要装对，要不然飞机会发生侧翻等危险情况！！！
- 分类：
  - 塑料：成本低，但性能低，脆弱
  - 碳纤维：啥都好就是贵
  - 木质：效率低下，平衡性好，震动小
- 型号：一般由4个数字表示，前面两位表示螺旋桨的直径，后面两位螺旋桨的螺距。
  - APC1045(10*45)：桨的直径10英寸，逻辑4.5英寸（1in = 2.54cm）
- 桨叶数
有实验表明：有实验表明二叶桨的力效会比三叶桨稍高一些
- 安全转速
超过安全转速，可能发生形变，导致效率降低

#### 2. 电机
- 无刷直流电机：效率高，便于小型化，制造成本比较低
  - 外转子电机
  - 内转子电机
- 尺寸：四位数字组成：2205（22*05），前面给两位代表定子的直径，后两位代表定子的高度
- kv值：
  - 空载情况下，外加1v电压得到的电机转速值
  - 单位RPM转每分钟
  - kv小的电机可以产生更大的力矩，大螺旋桨用小kv值

#### 3. 电调
- 电子调速器（ESC）
  - 调速：通过飞控板给定的PWM波形进行调速
  - 充当转换器的角色：无刷电机没有电刷换向，需要靠esc电子换相，将直接电源转化为三相电源供给无数电机
  - 常见参数
    1. 最大持续电流:最大持续电流正在工作模式下持续输出的电流
    2. 刷新频率 :  400hz

#### 4. 电池
1. 电压：小型飞行器专用的锂聚合电池，单节电芯的标称电压3.7v，满电4.2v，一般无人机3.6低电压报警
2. 组合：s表示串联series，p表示并联parallel
3. 容量 毫安时
5300毫安时的电池表示以5300毫安的电流放电可以持续一个小时

### 控制系统
#### 飞控
最底层的控制器，直接对无人机进行控制（输出pwm波，对电机进行控制）；其他的控制系统充当高级控制器，对飞控进行控制

#### 地面站
QGroundControl简介
- 飞行地图显示显示无人机位置、飞行轨迹、航路点和飞机
仪表。
- 对飞控进行配置，支持ArduPilot 和 PX4 Pro。
- 自主飞行的任务规划
- 显示视频流。
- QGC在 Windows、OS X、Linux 平台、iOS 和 Android 设
备上运行:
(https://docs.qgroundcontrol.com/master/en/getting_started/download_and_instal.html)
#### 遥控器
无人机最常用的远程控制单元形式如图所示。横滚/俯仰和油门/偏航的控制分别布置在摇杆上(飞行器最少需要4个通道)

##### 飞行模式
飞行模式一般来说分为**手动或自主**。手动模式是用户通过遥控器控制杆控制飞行器的运动，然而自主模式完全由飞控控制，并且不需要飞手的控制输入。
- Stabilized :自稳模式，直接控制无人机姿态
- Altitude :定高模式，高度可以恒定
- Position:定点模式，可以进行悬停
可以使用遥控上的开关或地面站来切换飞行模式

##### 初步认识
- 四个旋翼，对角旋向一致，相邻旋向相反，反扭矩相互抵消
![alt text](/images/image-87.png) 
- 通过控制四个旋翼的转速，实现四个自由度运动
  - 升降、偏航、俯仰、横滚
- 一些概念
  - 地理坐标系（NED）
    - “北-东-地”
    - 原点一般指无人机起飞点
    - N轴水平指北、D轴指向地心、E轴水平指东
    - 是右手系
  - 运载体坐标系（FRD）
    - 原点位于运载体质心
    - x轴沿运载体纵轴，指向前方
    - y轴沿运载体横轴，指向右翼
    - z轴与x轴、y轴构成右手系，指向运载体底部
  - 姿态角
    - 横滚角(φ，Roll)
      - y轴与水平面的夹角
    - 俯仰角(0，Pitch)
      - x轴与水平面的夹角
    - 偏航角(ψ，Yaw)
      - x轴在水平面的投影与N轴的夹角，顺时针为正

#### 机载计算机
- PX4 可以通过串行接线或 WiFi 由独立的机载飞计算机进行控制。
- 机载计算机通常使用MAVLinKAPI(如MAVSDK或MAVROS)进行通信。
  - Offboard 模式-用于从地面站或机载计算机对 PX4 进行 Offboard 控制的飞行模式

#### 传感器和外设
- 基于 PX4 的系统使用传感器来确定飞行器状态(自稳和启用自主控制所需)。
- 飞行器状态包括:位置/高度电池电量等航向，速度，空速，方向(姿态)，
- 系统 最低要求 陀螺仪，加速度计，磁力计(罗盘)和气压计。需要 GPS 或其他定位系统来启用所有自动模
式和一些辅助模式。
- 最小的传感器组合集成在 Pixhawk飞控板上。
- 附加：外部传感器可以连接到控制器。
![alt text](/images/image-88.png) 

#### GPS和罗盘和安全开关
- PX4 支持许多全球导航卫星系统(GNSS)罗盘(磁力计)。它还支持 实时动态(RTK)GPS接收器，它将 GPS 系统扩展到厘米级精通常
- GPS还自带罗盘，用于测定航向角。
- Pixhawk4 GPS集成了安全开关。当不在使用时PX4是加锁状态的，必须在起飞前进行解锁，
- Pixhawk4 GPS还集成了LED灯和蜂鸣器

#### 距离传感器
距离传感器用于精准着陆，避障和地形跟随。使用定高雷达定高会稳定很多。

#### 光流
传感器使用下视相机和向下的距离传感器进行速度估计。PX4 将光流传感器输出与来自其他定位源(例如 GPS)的信息融合以提供更准确的位置。该传感器可以用于没有 GPS 信号的室内。

#### 数传
数传电台 可以在诸如 OGC 地面站 与运行PX4 的机体之间提供无线 MAVLink 连接。这使得飞机飞行中调试参数、实时检查遥测信息、更改任务等等成为了可能

#### SD卡
SD卡用于记录无人机飞行信息，可以当作飞机的黑匣子
##### 飞行状态
PX4提供基于机载视觉(LED)和声音(蜂鸣器)的高级飞行状态和飞行准备提示。
- 例如，这些提示表明飞行器是否正确校准是否有SD卡，是否有位置锁定，是否可以安全起飞，是否解锁是否可以起飞等
- 此外，PX4在地面站的起飞前检查中提供更详细的关于起飞准备的信息。
![alt text](/images/image-89.png) 
### 指挥系统 